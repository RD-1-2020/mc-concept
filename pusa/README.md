# Сервис Pusa

`Pusa` — это веб-приложение, которое выступает в роли клиента для сервера конфигурации `Phoca`. Оно демонстрирует, как сервис может получать конфигурацию при запуске и динамически обновлять ее без перезапуска.

## Основные функции

1.  **Управление пользователями**:
    - Просмотр списка и создание новых пользователей.
    - Пароль нового пользователя валидируется согласно динамической политике безопасности.

2.  **Управление конфигурацией (Политика паролей)**:
    - Веб-интерфейс для просмотра и изменения параметров политики безопасности паролей (минимальная длина, требование к регистру, цифрам и спецсимволам).
    - Изменения отправляются в `Phoca` по gRPC.

## Технологический стек

- **Spring Boot**: Основа приложения.
- **Spring Web + Thymeleaf**: Для реализации веб-интерфейса.
- **Spring Data JPA**: Для работы с базой данных пользователей (`pusa_db` в PostgreSQL).
- **Spring Cloud Config Client**: Для получения конфигурации от `Phoca`.
- **Spring Cloud Bus**: Для получения уведомлений об изменении конфигурации через NATS.
- **gRPC Client**: Для отправки запросов на изменение конфигурации в `Phoca`.

## Взаимодействие и динамическое обновление

- **При запуске**: `Pusa` обращается к `Phoca` по **HTTP** для получения своей конфигурации (`spring.config.import`).
- **Во время работы**:
    1.  Пользователь изменяет политику паролей в веб-интерфейсе.
    2.  `Pusa` отправляет **gRPC** запрос `UpdateConfiguration` в `Phoca`.
    3.  `Pusa` подписан на события в NATS. При получении `RefreshRemoteApplicationEvent`, Spring Cloud автоматически запрашивает у `Phoca` обновленный набор свойств по HTTP.
    4.  После получения новых свойств, бины, аннотированные `@RefreshScope` (например, `PasswordPolicyProperties`), пересоздаются с новыми значениями, и приложение начинает использовать их без перезапуска.
