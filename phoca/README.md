# Phoca Service

`Phoca` - это центральный сервис управления конфигурацией. Он построен на основе `Spring Cloud Config Server` и отвечает за хранение, версионирование и безопасное предоставление конфигураций для всех микросервисов в системе.

## Основные функции

1.  **Предоставление конфигураций**: `Phoca` обслуживает HTTP запросы от клиентов (например, `Pusa`) для получения их конфигураций при запуске.
2.  **Хранение конфигураций**: В качестве бэкенда для хранения конфигураций используется база данных PostgreSQL (схема `phoca_db`). Это позволяет централизованно управлять свойствами приложений.
3.  **Обновление конфигураций**: Предоставляет gRPC API для внешних систем, позволяя им изменять значения конфигурации.
4.  **Рассылка уведомлений**: После изменения конфигурации `Phoca` отправляет сообщение в NATS через Spring Cloud Bus, чтобы оповестить все заинтересованные сервисы о необходимости обновить свою конфигурацию.

## Технологический стек

- **Spring Boot**: Основа приложения.
- **Spring Cloud Config Server**: Ядро сервиса, обеспечивающее логику сервера конфигурации.
- **Spring Data JPA / JDBC**: Для работы с базой данных конфигураций в PostgreSQL.
- **Spring Cloud Bus**: Для интеграции с NATS и рассылки уведомлений.
- **gRPC Server**: Для предоставления API для управления конфигурацией.

## Взаимодействие

- **Получение**: Клиенты (микросервисы) при старте запрашивают свою конфигурацию по стандартному REST API Spring Cloud Config.
- **Обновление**:
    - `Pusa` (или другой авторизованный сервис) вызывает gRPC метод `UpdateConfiguration` у `Phoca`.
    - `Phoca` обновляет значение в своей базе данных.
    - `Phoca` публикует событие `RefreshRemoteApplicationEvent` в NATS.
    - Все сервисы, подписанные на эту тему, получают событие и обновляют свой контекст.
