# Spring Cloud Bus через NATS

Этот модуль представляет собой кастомную реализацию ("биндер") для `Spring Cloud Bus`, позволяющую использовать NATS в качестве брокера сообщений для распространения событий (например, `RefreshRemoteApplicationEvent`).

## Назначение

Spring Cloud Bus абстрагирован от конкретного брокера сообщений (по умолчанию поддерживаются RabbitMQ/Kafka). Чтобы использовать NATS, который является легковесной альтернативой, необходимо реализовать логику отправки и получения сообщений. Этот модуль решает данную задачу.

## Реализация

Ключевые компоненты:

- **`NatsBusProperties`**: `@ConfigurationProperties` класс для настройки подключения к NATS (`spring.cloud.bus.nats.*`).
- **`NatsBusBridge`**: Основной компонент, который реализует интерфейс `BusBridge` и выполняет две функции:
    1.  При старте приложения подписывается на топик в NATS. При получении сообщения, десериализует его из JSON в `RemoteApplicationEvent` и передает ядру Spring Cloud Bus.
    2.  Перехватывает локальные `RemoteApplicationEvent` (с помощью `@EventListener`), сериализует их в JSON и отправляет в NATS.
- **`NatsBusAutoConfiguration`**: Spring `@Configuration`, которая автоматически создает и настраивает все необходимые бины при наличии модуля в classpath.

## Использование

Для подключения достаточно добавить этот модуль как зависимость в сервисе (`pusa` или `phoca`) и настроить подключение к NATS в `application.yml` через свойства `spring.cloud.bus.nats.*`.
