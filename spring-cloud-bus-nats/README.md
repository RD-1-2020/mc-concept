# Spring Cloud Bus over NATS

Этот модуль представляет собой кастомную реализацию (`binder`) для `Spring Cloud Bus`, позволяющую использовать NATS в качестве брокера сообщений для распространения событий, таких как обновление конфигурации.

## Назначение

Spring Cloud Bus абстрагирован от конкретной системы обмена сообщениями. По умолчанию он поддерживает RabbitMQ и Kafka. Чтобы использовать NATS, который является легковесной и высокопроизводительной альтернативой, необходимо предоставить собственную реализацию `ServiceMatcher` и механизма отправки/получения сообщений.

Этот модуль решает именно эту задачу.

## Реализация

Ключевые компоненты:

- **`NatsBusProperties`**: Класс для конфигурационных свойств, позволяющий настраивать подключение к NATS (например, URL сервера).
- **`NatsBusBridge`**: Основной компонент, который:
    - При старте приложения подписывается на определенный топик в NATS.
    - При получении сообщения из NATS, он преобразует его в `RemoteApplicationEvent` и передает его в Spring Cloud Bus для дальнейшей обработки (например, для обновления `@ConfigurationProperties`).
    - Слушает внутренние события Spring (`RemoteApplicationEvent`) и отправляет их в NATS, чтобы другие сервисы могли их получить.
- **`NatsBusAutoConfiguration`**: Spring Auto-configuration класс, который автоматически создает и настраивает бины `NatsBusBridge` и `ServiceMatcher` при наличии необходимых зависимостей в classpath.

## Использование

Для использования этого модуля достаточно добавить его как зависимость в сервисе (`pusa` или `phoca`) и настроить подключение к NATS в `application.yml`. Автоконфигурация автоматически подключит Spring Cloud Bus к NATS.
