# MC Concept - Управление конфигурацией (PoC)

Этот проект представляет собой концепцию (Proof of Concept) системы управления конфигурацией, построенную на основе Spring Cloud Config.

## Запуск

### Локальная разработка

Этот способ запускает только инфраструктуру (PostgreSQL и NATS) в Docker, оставляя их порты доступными для подключения. Сами сервисы `phoca` и `pusa` вы можете запускать и отлаживать напрямую из вашей IDE.

```shell
# Из корневой папки проекта
docker compose -f docker/docker-compose.yml up -d
```
После этого вы можете запустить `PhocaApplication` и `PusaApplication` из вашей IDE. Они подключатся к сервисам, запущенным в Docker.

Ну и открывайте вебку http://localhost:8080/.

## Архитектура

Система состоит из нескольких ключевых компонентов:

- **Сервис `phoca`**: Центральный сервер конфигурации на базе Spring Cloud Config Server. Хранит конфигурации в PostgreSQL и предоставляет их клиентам по HTTP. Также предоставляет gRPC API для изменения конфигураций.
- **Сервис `pusa`**: Веб-приложение для управления пользователями, которое выступает в роли клиента сервера конфигурации. Демонстрирует получение и динамическое обновление свойств.
- **PostgreSQL**: База данных с двумя схемами: `phoca_db` для хранения конфигураций и `pusa_db` для данных пользователей.
- **NATS**: Система обмена сообщениями, используемая для рассылки уведомлений об изменениях конфигурации через Spring Cloud Bus.
- **gRPC**: Протокол для обновления конфигурации в phoca.

Более подробные диаграммы (компонентов, последовательности, модели данных) находятся в папке `/doc`.

## Модули

- `phoca`: Реализация Spring Cloud Config Server.
- `pusa`: Веб-приложение (клиент).
- `shared`: Общий модуль с `.proto` файлами для gRPC.
- `spring-cloud-bus-nats`: Кастомная реализация интеграции Spring Cloud Bus с NATS.
- `doc`: Диаграммы архитектуры и процессов в формате PlantUML.
- `docker`: Docker-файлы и compose-конфигурации для развертывания.
